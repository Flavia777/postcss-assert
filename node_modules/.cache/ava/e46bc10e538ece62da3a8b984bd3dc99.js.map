{"version":3,"sources":["02-utilities.js"],"names":["t","background","backgroundImage","backgroundBlock","backgroundColor","truthy","falsy","deepEqual","local","http","base64","retina","nonRetina","retina2x","retina3x","hexLong","hexShort","rgb","rgba","empty","spritePath","groups","extension"],"mappings":"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","file":"02-utilities.js","sourcesContent":["import test from 'ava';\nimport {\n\thasImageInRule,\n\tgetImageUrl,\n\tisImageSupported,\n\tisRetinaImage,\n\tgetRetinaRatio,\n\tgetColor,\n\tmakeSpritesheetPath,\n\tisToken\n} from '../lib/core';\n\ntest('should detect background images in CSS rules', (t) => {\n\tconst background = '.selector-b { background: url(square.png) no-repeat 0 0; }';\n\tconst backgroundImage = '.selector-a { background-image: url(circle.png); }';\n\tconst backgroundBlock = `\n\t\t.selector-b {\n\t\t\tcolor: #fff;\n\t\t\tbackground: url(square.png) no-repeat 0 0\n\t\t}\n\t`;\n\tconst backgroundColor = '.selector-a { background: #fff; }';\n\n\tt.truthy(hasImageInRule(background));\n\tt.truthy(hasImageInRule(backgroundImage));\n\tt.truthy(hasImageInRule(backgroundBlock));\n\tt.falsy(hasImageInRule(backgroundColor));\n});\n\ntest('should return the url of an image', (t) => {\n\tconst background = '.selector-b { background: url(square.png) no-repeat 0 0; }';\n\tconst backgroundImage = '.selector-a { background-image: url(circle.png); }';\n\tconst backgroundBlock = `\n\t\t.selector-b {\n\t\t\tcolor: #fff;\n\t\t\tbackground: url(square.png) no-repeat 0 0\n\t\t}\n\t`;\n\tconst backgroundColor = '.selector-a { background: #fff; }';\n\n\tt.deepEqual(getImageUrl(background)[1], 'square.png');\n\tt.deepEqual(getImageUrl(backgroundImage)[1], 'circle.png');\n\tt.deepEqual(getImageUrl(backgroundBlock)[1], 'square.png');\n\tt.deepEqual(getImageUrl(backgroundColor)[1], '');\n});\n\ntest('shoud return the url of an image in compressed CSS rules', (t) => {\n\tconst background = '.selector-a{background:url(square.png) no-repeat 0 0;transform:scale(0.5)}';\n\tconst backgroundImage = '.selector-a{background-image:url(square.png);transform:scale(0.5)}';\n\tconst backgroundColor = '.selector-a{background:#fff;transform:scale(0.5)}';\n\n\tt.deepEqual(getImageUrl(background)[1], 'square.png');\n\tt.deepEqual(getImageUrl(backgroundImage)[1], 'square.png');\n\tt.deepEqual(getImageUrl(backgroundColor)[1], '');\n});\n\ntest('should remove get params', (t) => {\n\tconst background = '.selector-b { background: url(square.png?v1234) no-repeat 0 0; }';\n\tt.deepEqual(getImageUrl(background)[1], 'square.png');\n});\n\n\ntest('should remove the quotes', (t) => {\n\tconst background = '.selector-b { background: url(\"square.png\") no-repeat 0 0; }';\n\tt.deepEqual(getImageUrl(background)[1], 'square.png');\n});\n\ntest('should allow only local files', (t) => {\n\tconst local = 'sprite/test.png';\n\tconst http = 'http://example.com/test.png';\n\tconst base64 = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIA';\n\n\tt.truthy(isImageSupported(local));\n\tt.falsy(isImageSupported(http));\n\tt.falsy(isImageSupported(base64));\n});\n\ntest('should detect retina images', (t) => {\n\tconst retina = 'sprite/test@2x.png';\n\tconst nonRetina = 'sprite/test.png';\n\n\tt.truthy(isRetinaImage(retina));\n\tt.falsy(isRetinaImage(nonRetina));\n});\n\ntest('should extract the ratio of an image', (t) => {\n\tconst nonRetina = 'sprite/test.png';\n\tconst retina2x = 'sprite/test@2x.png';\n\tconst retina3x = 'sprite/test@3x.png';\n\n\tt.deepEqual(getRetinaRatio(nonRetina), 1);\n\tt.deepEqual(getRetinaRatio(retina2x), 2);\n\tt.deepEqual(getRetinaRatio(retina3x), 3);\n});\n\ntest('should extract color from declaration value', (t) => {\n\tconst hexLong = '#000000 url(image.png)';\n\tconst hexShort = '#000 url(image.png)';\n\tconst rgb = 'rgb(255, 255, 255) url(image.png)';\n\tconst rgba = 'rgb(255, 255, 255, .5) url(image.png)';\n\tconst empty = 'url(image.png)';\n\n\tt.deepEqual(getColor(hexLong), '#000000');\n\tt.deepEqual(getColor(hexShort), '#000');\n\tt.deepEqual(getColor(rgb), 'rgb(255, 255, 255)');\n\tt.deepEqual(getColor(rgba), 'rgb(255, 255, 255, .5)');\n\tt.deepEqual(getColor(empty), null);\n});\n\ntest('should generate spritesheet filename', (t) => {\n\tt.deepEqual(makeSpritesheetPath({ spritePath: './' }, { groups: [], extension: 'png' }), 'sprite.png');\n\tt.deepEqual(makeSpritesheetPath({ spritePath: './' }, { groups: ['@2x'], extension: 'png' }), 'sprite.@2x.png');\n});\n\ntest('should detect comment tokens', (t) => {\n\tt.truthy(isToken('/* @replace|circle.png */'));\n\tt.falsy(isToken('/* circle.png */'));\n});\n"]}